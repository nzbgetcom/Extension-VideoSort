name: tests

on:
  push:
    branches:
    - feature/*
    - master

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    
    - name: Checkout
      uses: actions/checkout@v3

    - name: Run tests
      run: |
        TEST_RESULTS=/tmp/videosort-test-results.txt
        for PYTHON_VERSION in 2 3 4 5 6 7 8 9 10 11 12; do
            docker pull python:3.$PYTHON_VERSION >/dev/null
            docker run -it python:3.$PYTHON_VERSION python --version
            docker run -it -v ./:/videosort python:3.$PYTHON_VERSION python /videosort/testsort.py > $TEST_RESULTS
            printf "SUCCESS: %2s FAILED: %2s\n" $(cat $TEST_RESULTS | grep SUCCESS | wc -l) $(cat $TEST_RESULTS | grep FAILED | wc -l)
        done
        rm $TEST_RESULTS
